# File Upload Architecture Diagram

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         User Interface Layer                            â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    task.tsx Component                           â”‚  â”‚
â”‚  â”‚                                                                 â”‚  â”‚
â”‚  â”‚  State:                                                        â”‚  â”‚
â”‚  â”‚  â€¢ uploadedFiles: File[]                                      â”‚  â”‚
â”‚  â”‚  â€¢ attachments: Attachment[]                                  â”‚  â”‚
â”‚  â”‚  â€¢ uploading: boolean                                         â”‚  â”‚
â”‚  â”‚                                                                 â”‚  â”‚
â”‚  â”‚  Methods:                                                      â”‚  â”‚
â”‚  â”‚  â€¢ handleFilesSelected()                                      â”‚  â”‚
â”‚  â”‚  â€¢ handleRemoveUploadedFile()                                 â”‚  â”‚
â”‚  â”‚  â€¢ submitNewTask()                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â†“                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚             FileUploadHandler Component (NEW)                  â”‚  â”‚
â”‚  â”‚                                                                 â”‚  â”‚
â”‚  â”‚  UI Elements:                                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“ Drag & Drop Zone (Drag Files Here)                 â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚
â”‚  â”‚  â”‚ âœ… Validation Errors (if any)                          â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚
â”‚  â”‚  â”‚ Uploaded Files Grid:                                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”                              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ â”‚ IMG1 â”‚ â”‚FILE1 â”‚ â”‚ IMG2 â”‚                              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜                              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“· Images â†’ images folder (5MB max)                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“„ Attachments â†’ files folder (25MB max)                â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                 â”‚  â”‚
â”‚  â”‚  Props: onFilesSelected, uploadedFiles, onRemoveFile         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Services Layer                                     â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          FileUploadService (ENHANCED)                          â”‚  â”‚
â”‚  â”‚                                                                 â”‚  â”‚
â”‚  â”‚  Public Methods:                                              â”‚  â”‚
â”‚  â”‚  â€¢ uploadFile(file)                                           â”‚  â”‚
â”‚  â”‚  â€¢ uploadMultipleFiles(files) â”€â†’ Returns FileUploadResult[]  â”‚  â”‚
â”‚  â”‚  â€¢ isImageFile(file)           â”€â†’ boolean                    â”‚  â”‚
â”‚  â”‚  â€¢ getUploadPath(file)         â”€â†’ 'images' | 'files'         â”‚  â”‚
â”‚  â”‚  â€¢ deleteFile(fileUrl)                                        â”‚  â”‚
â”‚  â”‚                                                                 â”‚  â”‚
â”‚  â”‚  Validation Methods (NEW):                                    â”‚  â”‚
â”‚  â”‚  â€¢ validateFile(file)          â”€â†’ FileValidationError | null â”‚  â”‚
â”‚  â”‚  â€¢ validateFilesBatch(files)   â”€â†’ FileValidationError[]      â”‚  â”‚
â”‚  â”‚                                                                 â”‚  â”‚
â”‚  â”‚  Private Validation:                                          â”‚  â”‚
â”‚  â”‚  â”œâ”€ validateFileType()         (Security check)              â”‚  â”‚
â”‚  â”‚  â”œâ”€ validateFileSize()         (5MB or 25MB)                 â”‚  â”‚
â”‚  â”‚  â”œâ”€ generateUniqueFileName()   (Timestamp + random)          â”‚  â”‚
â”‚  â”‚  â””â”€ checkTotalBatchSize()      (100MB max)                   â”‚  â”‚
â”‚  â”‚                                                                 â”‚  â”‚
â”‚  â”‚  Detection Logic:                                             â”‚  â”‚
â”‚  â”‚  â”œâ”€ MIME Type Check (Primary)                                â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ image/jpeg â”€â”€â†’ Image                                  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ image/png  â”€â”€â†’ Image                                  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ ...                                                    â”‚  â”‚
â”‚  â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  â””â”€ Extension Fallback                                        â”‚  â”‚
â”‚  â”‚     â”œâ”€ .jpg, .jpeg, .png â”€â”€â†’ Image                           â”‚  â”‚
â”‚  â”‚     â”œâ”€ .pdf, .doc, .xls  â”€â”€â†’ File                            â”‚  â”‚
â”‚  â”‚     â””â”€ .exe, .bat, .jar  â”€â”€â†’ BLOCKED                         â”‚  â”‚
â”‚  â”‚                                                                 â”‚  â”‚
â”‚  â”‚  Security Checks:                                             â”‚  â”‚
â”‚  â”‚  â”œâ”€ Executable Blocking (.exe, .bat, .jar, etc.)            â”‚  â”‚
â”‚  â”‚  â”œâ”€ MIME Type Validation                                     â”‚  â”‚
â”‚  â”‚  â”œâ”€ File Size Limits (5MB/25MB)                              â”‚  â”‚
â”‚  â”‚  â”œâ”€ Empty File Detection                                     â”‚  â”‚
â”‚  â”‚  â”œâ”€ Batch Size Limit (100MB)                                 â”‚  â”‚
â”‚  â”‚  â””â”€ Filename Sanitization                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â†“                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚               TaskService                                      â”‚  â”‚
â”‚  â”‚                                                                 â”‚  â”‚
â”‚  â”‚  Methods:                                                     â”‚  â”‚
â”‚  â”‚  â€¢ uploadTaskFiles(files)  â”€â†’ Promise<Attachment[]>          â”‚  â”‚
â”‚  â”‚  â€¢ removeTaskAttachment()                                     â”‚  â”‚
â”‚  â”‚  â€¢ isImageFile()                                              â”‚  â”‚
â”‚  â”‚                                                                 â”‚  â”‚
â”‚  â”‚  Uses: FileUploadService                                     â”‚  â”‚
â”‚  â”‚  Returns: Attachment[] with metadata                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Storage Layer                                      â”‚
â”‚                                                                         â”‚
â”‚  Firebase Storage Structure:                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ attachements/                                                â”‚    â”‚
â”‚  â”‚                                                               â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ images/                        (Folder for images)     â”‚    â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ photo_1704067200_abc.jpg                           â”‚    â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ screenshot_1704067205_def.png                      â”‚    â”‚
â”‚  â”‚  â”‚   â””â”€â”€ ...                                                 â”‚    â”‚
â”‚  â”‚  â”‚                                                            â”‚    â”‚
â”‚  â”‚  â””â”€â”€ files/                         (Folder for attachments) â”‚    â”‚
â”‚  â”‚      â”œâ”€â”€ document_1704067210_ghi.pdf                        â”‚    â”‚
â”‚  â”‚      â”œâ”€â”€ report_1704067215_jkl.xlsx                         â”‚    â”‚
â”‚  â”‚      â””â”€â”€ ...                                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â”‚  Local Reference Folders (for organization):                            â”‚
â”‚  â”œâ”€â”€ src/images/      (Reference structure)                            â”‚
â”‚  â””â”€â”€ src/attachment/  (Reference structure)                            â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## File Type Detection Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ File Input  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Get MIME Type + Ext    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check MIME Type (Primary)            â”‚
â”‚ Starts with "image/*" ?              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ YES                  â”‚ NO
       â”‚                      â”‚
       â–¼                      â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ IMAGE    â”‚      â”‚ Check Extension (FB)   â”‚
  â”‚ âœ“ Valid  â”‚      â”‚ In imageExtensions[] ? â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                        â”‚ YES          â”‚ NO
                        â”‚              â”‚
                        â–¼              â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ IMAGE  â”‚     â”‚ FILE     â”‚
                   â”‚âœ“ Valid â”‚     â”‚ âœ“ Valid  â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚              â”‚
                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                               â”‚
       â–¼                                               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Validate Image         â”‚          â”‚ Validate File          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ âœ“ Not empty            â”‚          â”‚ âœ“ Not empty            â”‚
  â”‚ âœ“ Size â‰¤ 5MB           â”‚          â”‚ âœ“ Size â‰¤ 25MB          â”‚
  â”‚ âœ“ Not executable       â”‚          â”‚ âœ“ Not executable       â”‚
  â”‚ âœ“ Valid MIME type      â”‚          â”‚ âœ“ Valid MIME type      â”‚
  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                    â”‚
       â–¼                                    â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Validate Batch (if multiple)                   â”‚
  â”‚ âœ“ Total size â‰¤ 100MB                           â”‚
  â”‚ âœ“ File count â‰¤ 10                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚ VALID       â”‚ INVALID
    â”‚             â”‚
    â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Upload â”‚   â”‚ Show Error   â”‚
â”‚   âœ“    â”‚   â”‚ Message      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Diagram

```
                          USER SELECTS FILES
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ handleFileSelect()     â”‚
                    â”‚ or handleDrop()        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ FileUploadHandler      â”‚
                    â”‚ .handleFiles()         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ FileUploadService              â”‚
                    â”‚ .validateFilesBatch()          â”‚
                    â”‚ (Security check)               â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚          â”‚
                       VALID â”‚          â”‚ INVALID
                             â–¼          â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Continue   â”‚  â”‚ Show Errors  â”‚
                    â”‚  Upload     â”‚  â”‚ User stops   â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ onFilesSelected()      â”‚
                    â”‚ Update uploadedFiles   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                 â”‚
              DISPLAY IN         USER SUBMITS
              PREVIEW             TASK FORM
                    â”‚                 â”‚
                    â–¼                 â”‚
            Show thumbnails           â”‚
            and file info             â”‚
                    â”‚                 â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ submitNewTask()        â”‚
                    â”‚ in task.tsx            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ TaskService                    â”‚
                    â”‚ .uploadTaskFiles(uploadedFiles)â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ For each file:                 â”‚
                    â”‚ 1. Check if image/file         â”‚
                    â”‚ 2. Upload to Firebase          â”‚
                    â”‚ 3. Get download URL            â”‚
                    â”‚ 4. Create Attachment object    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                         â”‚
        â–¼                                         â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚attachementâ”‚                         â”‚ attachment   â”‚
   â”‚ /images/ â”‚                         â”‚ /files/      â”‚
   â”‚           â”‚                         â”‚               â”‚
   â”‚ Files:   â”‚                         â”‚ Files:        â”‚
   â”‚ photo    â”‚                         â”‚ document.pdf  â”‚
   â”‚ screen   â”‚                         â”‚ report.xlsx   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Attachment[] Array     â”‚
                    â”‚ with metadata:         â”‚
                    â”‚ - fileName             â”‚
                    â”‚ - fileUrl              â”‚
                    â”‚ - fileType             â”‚
                    â”‚ - uploadPath           â”‚
                    â”‚ - uploadedAt           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ TaskRepository         â”‚
                    â”‚ .createTask(task)      â”‚
                    â”‚ with attachments       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Task Created with      â”‚
                    â”‚ attachments in         â”‚
                    â”‚ Firestore Database     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Interaction Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              task.tsx Component                  â”‚
â”‚                                                  â”‚
â”‚  State: uploadedFiles, attachments, uploading   â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Modal Dialog                               â”‚ â”‚
â”‚  â”‚                                            â”‚ â”‚
â”‚  â”‚ Task Name Input                            â”‚ â”‚
â”‚  â”‚ Description Input                          â”‚ â”‚
â”‚  â”‚ ... other fields ...                       â”‚ â”‚
â”‚  â”‚                                            â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚ â”‚ FileUploadHandler Component          â”‚  â”‚ â”‚
â”‚  â”‚ â”‚                                      â”‚  â”‚ â”‚
â”‚  â”‚ â”‚ â”€ Drag/Drop Zone                    â”‚  â”‚ â”‚
â”‚  â”‚ â”‚ â”€ File Preview Grid                 â”‚  â”‚ â”‚
â”‚  â”‚ â”‚ â”€ Validation Errors                 â”‚  â”‚ â”‚
â”‚  â”‚ â”‚ â”€ Info Box                          â”‚  â”‚ â”‚
â”‚  â”‚ â”‚                                      â”‚  â”‚ â”‚
â”‚  â”‚ â”‚ Props:                               â”‚  â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ onFilesSelected()                 â”‚  â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ uploadedFiles                     â”‚  â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ onRemoveFile()                    â”‚  â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                            â”‚ â”‚
â”‚  â”‚ Submit Button (Create Task)                â”‚ â”‚
â”‚  â”‚                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Calls on File Action:                      â”‚ â”‚
â”‚  â”‚                                            â”‚ â”‚
â”‚  â”‚ Files Selected/Dropped:                    â”‚ â”‚
â”‚  â”‚ â†’ onFilesSelected(files)                  â”‚ â”‚
â”‚  â”‚ â†’ setUploadedFiles(prev => [...])         â”‚ â”‚
â”‚  â”‚                                            â”‚ â”‚
â”‚  â”‚ File Removed:                              â”‚ â”‚
â”‚  â”‚ â†’ onRemoveFile(index)                     â”‚ â”‚
â”‚  â”‚ â†’ setUploadedFiles(prev => filter(...))   â”‚ â”‚
â”‚  â”‚                                            â”‚ â”‚
â”‚  â”‚ Submit Task:                               â”‚ â”‚
â”‚  â”‚ â†’ submitNewTask()                         â”‚ â”‚
â”‚  â”‚ â†’ taskService.uploadTaskFiles()           â”‚ â”‚
â”‚  â”‚ â†’ taskRepository.createTask()             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                              â”‚
         â”‚ Uses                         â”‚ Uses
         â–¼                              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ FileUpload   â”‚            â”‚ TaskService      â”‚
    â”‚ Service      â”‚            â”‚                  â”‚
    â”‚              â”‚            â”‚ â€¢ uploadTaskFilesâ”‚
    â”‚ â€¢ isImage    â”‚            â”‚ â€¢ removeAttach   â”‚
    â”‚ â€¢ getPath    â”‚            â”‚                  â”‚
    â”‚ â€¢ validate   â”‚            â”‚ Uses:            â”‚
    â”‚ â€¢ upload     â”‚            â”‚ FileUploadServiceâ”‚
    â”‚ â€¢ delete     â”‚            â”‚ TaskRepository   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
                  Firebase Storage
                  & Firestore
```

This architecture ensures:
- âœ… Clean separation of concerns
- âœ… Reusable components
- âœ… Easy testing
- âœ… Scalable design
- âœ… Security at every level
- âœ… User-friendly experience
