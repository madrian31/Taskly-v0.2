const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/login-C7iP1ZZi.js","assets/vendor_react-CfLwTqu8.js","assets/vendor-DuPUYBON.js","assets/vendor_firebase-CZSQ0ZSP.js","assets/home-BdvooctS.js","assets/App-DEF85R_q.css","assets/task-g8tQ0sav.js","assets/task-Bwuw-X_A.css","assets/users-Dek-kZyw.js","assets/users-yjea5Z32.css","assets/dashboard-M_xk8LYg.js","assets/accessNotAvailable-CBaT30kC.js","assets/layout-B7ChFUc8.js","assets/layout-724H31W2.css","assets/main-layout-Sd_sVMwX.js","assets/main-layout-BPKYgo-Z.css"])))=>i.map(i=>d[i]);
import{j as e,L as N,u as I,r as a,N as j,c as k,H as q,R as z,a as m}from"./vendor_react-CfLwTqu8.js";import{i as C,g as F,a as V,o as B,G,s as M,b as $,c as E,d as H,e as _,f as J,h as K,j as W,u as X,k as Y,l as S}from"./vendor_firebase-CZSQ0ZSP.js";import"./vendor-DuPUYBON.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))u(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&u(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function u(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();const Z="modulepreload",Q=function(i){return"/Taskly-v0.2/"+i},L={},h=function(t,r,u){let s=Promise.resolve();if(r&&r.length>0){let v=function(o){return Promise.all(o.map(d=>Promise.resolve(d).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),l=c?.nonce||c?.getAttribute("nonce");s=v(r.map(o=>{if(o=Q(o),o in L)return;L[o]=!0;const d=o.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${p}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":Z,d||(f.as="script"),f.crossOrigin="",f.href=o,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((R,y)=>{f.addEventListener("load",R),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${o}`)))})}))}function n(c){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=c,window.dispatchEvent(l),!l.defaultPrevented)throw c}return s.then(c=>{for(const l of c||[])l.status==="rejected"&&n(l.reason);return t().catch(n)})};function ee({id:i,children:t}){return e.jsx("section",{id:i,className:"section center",children:t})}function te(){return e.jsxs(ee,{children:[e.jsx("h1",{children:"Taskly"}),e.jsx(N,{to:"/login",children:"Get Started"})]})}const se={apiKey:"AIzaSyDbeHsZ1hrXAnCRePrfJFqkSDelKOGtqJU",authDomain:"taskly-2542f.firebaseapp.com",projectId:"taskly-2542f",storageBucket:"taskly-2542f.firebasestorage.app",messagingSenderId:"141937666380",appId:"1:141937666380:web:8a8aa08b12e2e4490887e9",measurementId:"G-MY6GLXVEPJ"},D=C(se),A=F(D),g=V(D);class re{onAuthStateChanged(t){return B(A,t)}async signInWithGoogle(){const t=new G;return await M(A,t)}async signOutUser(){await $(A)}getCurrentUser(){return A.currentUser}}const O=new re;function w(i,t){return{id:i,uid:t.uid??t.authUid??void 0,displayName:t.displayName??t.name,email:t.email,photoURL:t.photoURL,role:t.role??"user",department:t.department,status:t.status,lastActive:t.lastActive,createdAt:t.createdAt?.seconds?t.createdAt.seconds*1e3:t.createdAt??Date.now()}}class ne{constructor(){this.col=E(g,"users")}async getAll(){return(await H(this.col)).docs.map(r=>w(r.id,r.data()))}async getById(t){const r=_(g,"users",t),u=await J(r);return u.exists()?w(u.id,u.data()):null}async create(t){return(await K(E(g,"users"),{...t,createdAt:t.createdAt??Date.now()})).id}async upsertByUid(t,r){const u=_(g,"users",t);await W(u,{...r,uid:t,updatedAt:S(),createdAt:S()},{merge:!0})}async update(t,r){await X(_(g,"users",t),r)}async delete(t){await Y(_(g,"users",t))}}const U=new ne;function oe({children:i}){const t=I(),[r,u]=a.useState(void 0),[s,n]=a.useState(void 0),l=["/login","/access-not-available"].includes(t.pathname);return a.useEffect(()=>{const v=O.onAuthStateChanged(async o=>{if(u(o??null),o)try{const p=(await U.getById(o.uid))?.status??"active";n(p)}catch(d){console.error("RequireAuth: failed to fetch user document",d),n("active")}else n(void 0)});return()=>v()},[]),l?e.jsx(e.Fragment,{children:i}):r===void 0?e.jsx("div",{children:"Loading..."}):r?s===void 0?e.jsx("div",{children:"Loading..."}):s!=="active"?e.jsx(j,{to:"/access-not-available",replace:!0}):e.jsx(e.Fragment,{children:i}):e.jsx(j,{to:"/login",replace:!0})}function P({children:i,allowedRoles:t,allowedStatuses:r}){const u=I(),[s,n]=a.useState(void 0),[c,l]=a.useState(void 0),[v,o]=a.useState(void 0),p=["/login","/access-not-available"].includes(u.pathname);return a.useEffect(()=>{const R=O.onAuthStateChanged(async y=>{if(l(y??null),y)try{const x=await U.getById(y.uid),b=x?.status??"active",T=x?.role??"user";n(b),o(T),(r??["active"]).includes(b)||console.warn("RequireRole: user status not allowed",b)}catch(x){console.error("RequireRole: failed to fetch user document",x),n("active"),o("user")}else n(void 0),o(void 0)});return()=>R()},[r]),p?e.jsx(e.Fragment,{children:i}):c===void 0?e.jsx("div",{children:"Loading..."}):c?v===void 0||s===void 0?e.jsx("div",{children:"Loading..."}):(r??["active"]).includes(s)?t.includes("everyone")||t.includes(v)?e.jsx(e.Fragment,{children:i}):e.jsx(j,{to:"/access-not-available",replace:!0}):e.jsx(j,{to:"/access-not-available",replace:!0}):e.jsx(j,{to:"/login",replace:!0})}const ae=a.lazy(()=>h(()=>import("./login-C7iP1ZZi.js"),__vite__mapDeps([0,1,2,3])));a.lazy(()=>h(()=>import("./home-BdvooctS.js"),__vite__mapDeps([4,1,2,3,5])));const ie=a.lazy(()=>h(()=>import("./task-g8tQ0sav.js"),__vite__mapDeps([6,1,2,3,7,5]))),ce=a.lazy(()=>h(()=>import("./users-Dek-kZyw.js"),__vite__mapDeps([8,1,2,3,9]))),ue=a.lazy(()=>h(()=>import("./dashboard-M_xk8LYg.js"),__vite__mapDeps([10,1,2,3,5]))),le=a.lazy(()=>h(()=>import("./accessNotAvailable-CBaT30kC.js"),__vite__mapDeps([11,1,2,3,5]))),de=a.lazy(()=>h(()=>import("./layout-B7ChFUc8.js"),__vite__mapDeps([12,1,2,13]))),pe=a.lazy(()=>h(()=>import("./main-layout-Sd_sVMwX.js"),__vite__mapDeps([14,1,2,3,15])));k.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(q,{children:e.jsx(a.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsxs(z,{children:[e.jsx(m,{path:"/",element:e.jsx(te,{})}),e.jsxs(m,{element:e.jsx(de,{}),children:[e.jsx(m,{path:"/login",element:e.jsx(ae,{})}),e.jsx(m,{path:"/access-not-available",element:e.jsx(le,{})})]}),e.jsxs(m,{element:e.jsx(oe,{children:e.jsx(pe,{})}),children:[e.jsx(m,{path:"/dashboard",element:e.jsx(P,{allowedRoles:["user","admin"],children:e.jsx(ue,{})})}),e.jsx(m,{path:"/task",element:e.jsx(ie,{})}),e.jsx(m,{path:"/users",element:e.jsx(P,{allowedRoles:["admin"],children:e.jsx(ce,{})})})]})]})})})}));export{O as A,ee as S,U,A as a,g as d};
