import{u as c,r as i,j as o}from"./vendor_react-DAGpP-PG.js";import{A as a,S as p,U as h}from"./index-kRdZ_J6_.js";import"./vendor-DuPUYBON.js";import"./vendor_firebase-CZSQ0ZSP.js";function x(){const r=c(),[n,u]=i.useState(!0);i.useEffect(()=>{const e=a.onAuthStateChanged(s=>{s&&r("/dashboard"),u(!1)});return()=>e()},[r]);const d=async()=>{try{const e=await a.signInWithGoogle();if(e&&e.user){const s=e.user.providerData&&e.user.providerData.length>0?e.user.providerData[0].photoURL:void 0,t=e.user.photoURL??s??void 0;try{console.log("Upserting user",{uid:e.user.uid,photo:t,displayName:e.user.displayName}),await h.upsertByUid(e.user.uid,{displayName:e.user.displayName??void 0,email:e.user.email??void 0,photoURL:t,role:"user"})}catch(l){console.error("Failed to upsert user:",l)}r("/dashboard")}}catch(e){console.error(e)}};return n?o.jsx("div",{children:"Loading..."}):o.jsxs(p,{id:"login",children:[o.jsx("h1",{children:"Login"}),o.jsx("p",{children:"Welcome back! Please log in to continue."}),o.jsx("button",{onClick:d,children:"Sign in with Google"})]})}export{x as default};
