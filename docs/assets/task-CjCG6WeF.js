import{r as c,j as e,S as Ee,F as Ie,P as H,C as me,b as ue,d as De,e as Re,f as he,g as xe,E as fe,h as ge,T as ye,i as $e,k as ke,D as Me,l as je,m as Ae,n as Pe}from"./vendor_react-ByBjJ8Oe.js";/* empty css            */import{d as N,S as Be}from"./index-DMRkiqCx.js";import{c as Le,d as X,q as Oe,w as qe,e as $,f as We,T as S,h as Ve,u as ve,j as Ge,k as Qe,r as be,l as He,m as Xe,n as Je}from"./vendor_firebase-kU5F968d.js";import"./vendor-DuPUYBON.js";class Ke{constructor(){this.ref=Le(N,"tasks")}async getAllTasks(){return(await X(this.ref)).docs.map(a=>({id:a.id,...a.data()}))}async getMainTasks(){return(await X(this.ref)).docs.map(a=>({id:a.id,...a.data()})).filter(a=>a.parent_id===null||a.parent_id===void 0)}async getSubTasks(t){const a=Oe(this.ref,qe("parent_id","==",t));return(await X(a)).docs.map(o=>({id:o.id,...o.data()}))}async getTaskById(t){const a=$(N,"tasks",t),i=await We(a);return i.exists()?{id:i.id,...i.data()}:null}async createTask(t){if(t.priority<1||t.priority>4)throw new Error("Priority must be between 1 and 4");const a=S.now();await Ve(this.ref,{task_name:t.task_name,description:t.description??null,parent_id:t.parent_id??null,status:t.status??"todo",priority:t.priority,due_date:t.due_date?S.fromDate(t.due_date):null,attachments:t.attachments??null,created_at:a,updated_at:a,completed_at:t.status==="done"?a:null})}async updateStatus(t,a){if(!["todo","in_progress","blocked","done"].includes(a))throw new Error("Invalid status value");const i=S.now(),o=$(N,"tasks",t);await ve(o,{status:a,updated_at:i,completed_at:a==="done"?i:null})}async updateTask(t,a){const i=S.now(),o=$(N,"tasks",t),r={...a,updated_at:i};a.due_date&&(r.due_date=S.fromDate(a.due_date)),Object.keys(r).forEach(m=>{r[m]===void 0&&delete r[m]}),await ve(o,r)}async deleteTask(t){await Ge($(N,"tasks",t))}}class Ye{constructor(t,a){this.taskRepository=t,this.fileUploadService=a}async completeTask(t){await this.taskRepository.updateStatus(t,"done")}async reopenTask(t){await this.taskRepository.updateStatus(t,"todo")}async updateStatus(t,a){await this.taskRepository.updateStatus(t,a)}async deleteTask(t){try{const a=await this.taskRepository.getTaskById(t);if(a&&a.attachments&&this.fileUploadService)for(const i of a.attachments)try{await this.fileUploadService.deleteFile(i.fileUrl)}catch(o){console.error("Failed to delete attachment for task:",i.fileUrl,o)}try{const i=await this.taskRepository.getSubTasks(t);for(const o of i){if(o&&o.attachments&&this.fileUploadService)for(const r of o.attachments)try{await this.fileUploadService.deleteFile(r.fileUrl)}catch(m){console.error("Failed to delete attachment for subtask:",r.fileUrl,m)}if(o.id)try{await this.taskRepository.deleteTask(o.id)}catch(r){console.error("Failed to delete subtask doc:",o.id,r)}}}catch(i){console.error("Failed to fetch subtasks for deletion:",i)}await this.taskRepository.deleteTask(t)}catch(a){throw console.error("Error deleting task:",a),a}}async uploadTaskFiles(t){if(!this.fileUploadService)throw new Error("FileUploadService is not configured");try{console.log(`[TaskService] Starting file upload for ${t.length} file(s)`);const a=await this.fileUploadService.uploadMultipleFiles(t);return console.log(`[TaskService] File upload successful, got ${a.length} results`),a.map((i,o)=>({id:`attachment_${Date.now()}_${o}`,fileName:i.fileName,fileUrl:i.fileUrl,fileType:i.fileType,uploadedAt:i.uploadedAt}))}catch(a){throw console.error("Error uploading task files:",a),a}}async removeTaskAttachment(t,a,i){try{this.fileUploadService&&await this.fileUploadService.deleteFile(i.fileUrl);const o=await this.taskRepository.getTaskById(t);if(!o)throw new Error("Task not found");const r=o.attachments?.filter(m=>m.id!==a);await this.taskRepository.updateTask(t,{attachments:r})}catch(o){throw console.error("Error removing task attachment:",o),o}}isImageFile(t){if(!this.fileUploadService){const a=["jpg","jpeg","png","gif","webp"],i=t.name.split(".").pop()?.toLowerCase()||"";return t.type.startsWith("image/")||a.includes(i)}return this.fileUploadService.isImageFile(t)}}class Ze{constructor(){this.storage=Qe(),this.allowedImageMimeTypes=["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/svg+xml","image/bmp","image/x-icon","image/tiff","image/avif"],this.imageExtensions=["jpg","jpeg","png","gif","webp","svg","bmp","ico","tiff","tif","avif"],this.blockedExtensions=["exe","bat","cmd","com","pif","scr","vbs","js","jar","zip","rar","7z"],this.blockedMimeTypes=["application/x-msdownload","application/x-msdos-program","application/x-executable"],this.maxImageSize=5*1024*1024,this.maxAttachmentSize=25*1024*1024,this.maxTotalUploadSize=100*1024*1024}validateFileType(t){const i=t.name.toLowerCase().split(".").pop()||"",o=t.type.toLowerCase();return this.blockedExtensions.includes(i)?{fileName:t.name,reason:`File type "${i}" is not allowed for security reasons`}:this.blockedMimeTypes.some(r=>o.includes(r))?{fileName:t.name,reason:`File MIME type "${o}" is not allowed for security reasons`}:i?null:{fileName:t.name,reason:"File must have a valid extension"}}isImageFile(t){const a=t.type.toLowerCase(),o=t.name.toLowerCase().split(".").pop()||"";return this.allowedImageMimeTypes.includes(a)?!0:this.imageExtensions.includes(o)}getUploadPath(t){return this.isImageFile(t)?"images":"files"}validateFile(t,a=!1){const i=this.validateFileType(t);if(i)return i;const o=a?this.maxImageSize:this.maxAttachmentSize;if(t.size===0)return{fileName:t.name,reason:"File is empty"};if(t.size>o){const r=a?5:25;return{fileName:t.name,reason:`File exceeds ${r}MB size limit (${(t.size/1024/1024).toFixed(2)}MB)`}}return null}validateFilesBatch(t){const a=[];let i=0;for(const o of t){const r=this.isImageFile(o),m=this.validateFile(o,r);m&&a.push(m),i+=o.size}return i>this.maxTotalUploadSize&&a.push({fileName:"Multiple files",reason:`Total upload size exceeds 100MB limit (${(i/1024/1024).toFixed(2)}MB)`}),a}generateUniqueFileName(t){const a=Date.now(),i=Math.random().toString(36).substring(2,9),o=t.name.split(".").pop()||"";return`${(t.name.substring(0,t.name.lastIndexOf("."))||t.name).replace(/[^a-z0-9_-]/gi,"").substring(0,30)}_${a}_${i}.${o}`}async uploadFile(t){try{const a=this.isImageFile(t);console.log(`[FileUploadService] Uploading: ${t.name} (${a?"Image":"File"}) - Size: ${(t.size/1024/1024).toFixed(2)}MB`);const i=this.validateFile(t,a);if(i)throw console.error(`[FileUploadService] Validation failed for ${t.name}: ${i.reason}`),new Error(i.reason);const o=this.getUploadPath(t),r=this.generateUniqueFileName(t),m=`attachements/${o}/${r}`;console.log(`[FileUploadService] Storage path: ${m}`);const y=be(this.storage,m);console.log("[FileUploadService] Starting upload to Firebase..."),await He(y,t),console.log(`[FileUploadService] Upload complete for ${t.name}`),console.log("[FileUploadService] Getting download URL...");const M=await Xe(y);return console.log("[FileUploadService] Got download URL"),{fileName:t.name,fileUrl:M,fileType:t.type,uploadPath:o,uploadedAt:new Date}}catch(a){throw console.error("Error uploading file:",a),new Error(`Failed to upload ${t.name}: ${a.message}`)}}async uploadMultipleFiles(t){try{console.log(`[FileUploadService] Starting batch upload of ${t.length} file(s)`);const a=this.validateFilesBatch(t);if(a.length>0){const o=a.map(r=>`${r.fileName}: ${r.reason}`).join(`
`);throw console.error(`[FileUploadService] Validation errors: ${o}`),new Error(`File validation failed:
${o}`)}const i=[];for(const o of t){const r=await this.uploadFile(o);i.push(r)}return console.log(`[FileUploadService] Batch upload complete: ${i.length} file(s) uploaded`),i}catch(a){throw console.error("Error uploading multiple files:",a),a}}async deleteFile(t){try{const a=t.split("/o/")[1];if(!a)throw new Error("Invalid file URL");const i=decodeURIComponent(a.split("?")[0]),o=be(this.storage,i);await Je(o)}catch(a){throw console.error("Error deleting file:",a),new Error(`Failed to delete file: ${a.message}`)}}}const T=new Ke,F=new Ze,J=new Ye(T,F);function ns(){const[C,t]=c.useState([]),[a,i]=c.useState({}),[o,r]=c.useState(!0),[m,y]=c.useState(!1),[M,K]=c.useState(!1),[x,_]=c.useState(!1),[Y,z]=c.useState(null),[A,we]=c.useState("all"),[P,Ne]=c.useState(""),[Se,Te]=c.useState(new Set),[U,Z]=c.useState(null),[k,B]=c.useState(null),[u,L]=c.useState({task_name:"",description:"",priority:3,status:"todo",due_date:""}),[Fe,E]=c.useState(!1),[h,v]=c.useState([]),[f,b]=c.useState([]),[g,I]=c.useState(!1);c.useEffect(()=>{O()},[]);async function O(){try{r(!0),console.log("Loading tasks from Firestore...");const s=await T.getMainTasks();console.log("Main tasks loaded:",s),t(s);const n={};for(const l of s)if(l.id){const p=await T.getSubTasks(l.id);n[l.id]=p}i(n)}catch(s){console.error("Error loading tasks:",s),alert("Error loading tasks: "+s.message)}finally{r(!1)}}async function ee(s){try{await J.deleteTask(s),await O()}catch(n){console.error("Error deleting task:",n),alert("Error deleting task: "+n.message)}}function q(s){L({task_name:"",description:"",priority:3,status:"todo",due_date:""}),E(!1),B(null),v([]),b([]),s?(_(!0),z(s)):(_(!1),z(null)),y(!0)}function D(){y(!1),E(!1),_(!1),z(null),B(null),v([]),b([])}function se(s){L({task_name:s.task_name||"",description:s.description||"",priority:s.priority||2,status:s.status||"todo",due_date:s.due_date?s.due_date.seconds?new Date(s.due_date.seconds*1e3).toISOString().slice(0,10):new Date(s.due_date).toISOString().slice(0,10):""}),B(s.id||null),_(s.parent_id!==null&&s.parent_id!==void 0),z(s.parent_id??null),b(s.attachments||[]),v([]),y(!0)}function W(){K(!1)}function w(s){const{name:n,value:l}=s.target;L(p=>({...p,[n]:l}))}function Ce(s){const n=s.target.files;if(n){const l=Array.from(n);v(p=>[...p,...l])}}function te(s){v(n=>n.filter((l,p)=>p!==s))}async function ae(s){const n=f.find(l=>l.id===s);if(k&&n)try{I(!0),await J.removeTaskAttachment(k,s,n),b(l=>l.filter(p=>p.id!==s))}catch(l){console.error("Error removing attachment:",l),alert("Failed to remove attachment: "+l.message)}finally{I(!1)}else b(l=>l.filter(p=>p.id!==s))}function R(s){return["image/jpeg","image/png","image/gif","image/webp","image/svg+xml"].includes(s.fileType.toLowerCase())}function _e(s){Te(n=>{const l=new Set(n);return l.has(s)?l.delete(s):l.add(s),l})}function ie(s){Z(n=>n===s?null:s)}function j(){Z(null)}c.useEffect(()=>{function s(){j()}return document.addEventListener("click",s),()=>document.removeEventListener("click",s)},[]);function oe(){let s=C;if(A!=="all"&&(s=s.filter(n=>{switch(A){case"todo":return n.status==="todo";case"in_progress":return n.status==="in_progress";case"done":return n.status==="done";default:return!0}})),P.trim()){const n=P.toLowerCase();s=s.filter(l=>l.task_name.toLowerCase().includes(n)||l.description&&l.description.toLowerCase().includes(n))}return s}function ne(s){switch(s){case"todo":return{icon:ue,color:"text-slate-400"};case"in_progress":return{icon:me,color:"text-blue-500"};case"done":return{icon:Pe,color:"text-emerald-500"};default:return{icon:Ae,color:"text-red-500"}}}function le(s){switch(s){case 1:return{color:"text-slate-400",text:"P4"};case 2:return{color:"text-blue-500",text:"P3"};case 3:return{color:"text-orange-500",text:"P2"};case 4:return{color:"text-red-500",text:"P1"};default:return{color:"text-slate-400",text:"P4"}}}function re(s){if(!s)return"No date";const n=s;return(n.seconds?new Date(n.seconds*1e3):new Date(s)).toLocaleDateString("en-US",{month:"short",day:"numeric"})}async function de(s){if(s&&s.preventDefault&&s.preventDefault(),E(!0),!(!u.task_name||u.task_name.trim()===""))try{I(!0);let n=[...f];if(h.length>0){console.log(`[task.tsx] Uploading ${h.length} new file(s)`);const p=await J.uploadTaskFiles(h);console.log(`[task.tsx] Got ${p.length} attachment(s) with URLs`),n=[...f,...p]}const l={task_name:u.task_name.trim(),description:u.description.trim()||void 0,status:u.status,priority:Number(u.priority),due_date:u.due_date?new Date(u.due_date):void 0,parent_id:x&&Y?Y:void 0,attachments:n.length>0?n:void 0};console.log("Submitting task:",l),console.log(`[task.tsx] Task has ${n.length} attachment(s)`),k?(await T.updateTask(k,l),console.log("Task updated successfully!")):(await T.createTask(l),console.log("Task created successfully!")),await O(),console.log("Tasks reloaded"),E(!1),D(),K(!0)}catch(n){console.error("Error adding task from modal:",n),alert("Failed to add task: "+n.message+`

Check console for details.`)}finally{I(!1)}}return e.jsxs(Be,{id:"task",children:[e.jsxs("div",{className:"task-header-section",children:[e.jsxs("div",{className:"header-content",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("h1",{className:"header-title",children:"Tasks"}),e.jsx("p",{className:"header-subtitle",children:"Manage your tasks effectively with Taskly"})]}),e.jsxs("div",{className:"header-right",children:[e.jsxs("div",{className:"search-container",children:[e.jsx(Ee,{className:"search-icon",size:20}),e.jsx("input",{type:"text",placeholder:"Search tasks...",className:"search-input",value:P,onChange:s=>Ne(s.target.value)})]}),e.jsx("button",{className:"filter-button",children:e.jsx(Ie,{size:20})}),e.jsxs("button",{className:"new-task-button",onClick:()=>q(),children:[e.jsx(H,{size:20}),"New Task"]})]})]}),e.jsx("div",{className:"filter-tabs",children:[{key:"all",label:"All Tasks"},{key:"todo",label:"To Do"},{key:"in_progress",label:"In Progress"},{key:"done",label:"Done"}].map(s=>e.jsx("button",{className:`filter-tab ${A===s.key?"active":""}`,onClick:()=>we(s.key),children:s.label},s.key))})]}),e.jsx("div",{className:"task-list-container",children:o?e.jsxs("div",{className:"loading-state",children:[e.jsx(me,{className:"animate-spin",size:24}),e.jsx("p",{children:"Loading tasks..."})]}):oe().length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(ue,{size:48,className:"text-slate-300"}),e.jsx("h3",{children:"No tasks found"}),e.jsx("p",{children:"Get started by creating your first task!"}),e.jsxs("button",{className:"empty-state-button",onClick:()=>q(),children:[e.jsx(H,{size:20}),"Create Task"]})]}):e.jsx("div",{className:"tasks-list",children:oe().map(s=>{const n=s.id?a[s.id]||[]:[],l=n.length>0,p=s.id?Se.has(s.id):!1,ce=ne(s.status),V=le(s.priority),ze=ce.icon;return e.jsxs("div",{className:"task-row-container",children:[e.jsxs("div",{className:"task-row",children:[e.jsx("button",{className:"expand-button",onClick:()=>s.id&&l&&_e(s.id),disabled:!l,children:l?p?e.jsx(De,{size:16,className:"text-slate-500"}):e.jsx(Re,{size:16,className:"text-slate-500"}):e.jsx("div",{className:"w-4 h-4"})}),e.jsxs("div",{className:"task-content",children:[e.jsx("div",{className:"task-title-row",children:e.jsx("h3",{className:"task-title",children:s.task_name})}),s.description&&e.jsx("p",{className:"task-description",children:s.description})]}),e.jsxs("div",{className:"status-badge",children:[e.jsx(ze,{size:16,className:ce.color}),e.jsx("span",{className:"status-text",children:s.status.replace("_"," ")})]}),e.jsxs("div",{className:"priority-badge",children:[e.jsx(he,{size:16,className:V.color}),e.jsx("span",{className:`priority-text ${V.color}`,children:V.text})]}),e.jsxs("div",{className:"due-date",children:[e.jsx(xe,{size:16,className:"text-slate-500"}),e.jsx("span",{className:"due-date-text",children:re(s.due_date)})]}),e.jsx("div",{className:"task-actions-dropdown",children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{className:"more-actions-button",onClick:d=>{d.stopPropagation(),s.id&&ie(s.id)},"aria-expanded":U===s.id,children:e.jsx(fe,{size:16,className:"text-slate-500"})}),U===s.id&&e.jsxs("div",{className:"dropdown-menu",onClick:d=>d.stopPropagation(),children:[(s.parent_id===null||s.parent_id===void 0)&&e.jsxs("div",{className:"dropdown-item",onClick:()=>{j(),s.id&&q(s.id)},children:[e.jsx(H,{size:14}),e.jsx("span",{children:"Add Subtask"})]}),e.jsxs("div",{className:"dropdown-item",onClick:()=>{j(),se(s)},children:[e.jsx(ge,{size:14}),e.jsx("span",{children:"Edit Task"})]}),e.jsxs("div",{className:"dropdown-item delete",onClick:()=>{j(),s.id&&ee(s.id)},children:[e.jsx(ye,{size:14}),e.jsx("span",{children:"Delete Task"})]})]})]})})]}),l&&p&&e.jsxs("div",{className:"subtasks-container",children:[e.jsx("div",{className:"connector-line"}),n.map((d,es)=>{const pe=ne(d.status),G=le(d.priority),Ue=pe.icon;return e.jsxs("div",{className:"subtask-row",children:[e.jsx("div",{className:"horizontal-connector"}),e.jsxs("div",{className:"subtask-card",children:[e.jsx("div",{className:"expand-button-placeholder"}),e.jsxs("div",{className:"task-content",children:[e.jsx("div",{className:"task-title-row",children:e.jsx("h4",{className:"subtask-title",children:d.task_name})}),d.description&&e.jsx("p",{className:"task-description",children:d.description})]}),e.jsxs("div",{className:"status-badge",children:[e.jsx(Ue,{size:16,className:pe.color}),e.jsx("span",{className:"status-text",children:d.status.replace("_"," ")})]}),e.jsxs("div",{className:"priority-badge",children:[e.jsx(he,{size:16,className:G.color}),e.jsx("span",{className:`priority-text ${G.color}`,children:G.text})]}),e.jsxs("div",{className:"due-date",children:[e.jsx(xe,{size:16,className:"text-slate-500"}),e.jsx("span",{className:"due-date-text",children:re(d.due_date)})]}),e.jsx("div",{className:"task-actions-dropdown",children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{className:"more-actions-button",onClick:Q=>{Q.stopPropagation(),d.id&&ie(d.id)},"aria-expanded":U===d.id,children:e.jsx(fe,{size:16,className:"text-slate-500"})}),U===d.id&&e.jsxs("div",{className:"dropdown-menu",onClick:Q=>Q.stopPropagation(),children:[e.jsxs("div",{className:"dropdown-item",onClick:()=>{j(),se(d)},children:[e.jsx(ge,{size:14}),e.jsx("span",{children:"Edit Task"})]}),e.jsxs("div",{className:"dropdown-item delete",onClick:()=>{j(),d.id&&ee(d.id)},children:[e.jsx(ye,{size:14}),e.jsx("span",{children:"Delete Task"})]})]})]})})]})]},d.id)})]})]},s.id)})})}),m&&e.jsx("div",{className:"task-modal-overlay",onClick:D,children:e.jsxs("div",{className:"task-modal",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"task-modal-header",children:[e.jsx("h2",{className:"task-modal-title",children:k?x?"Edit Subtask":"Edit Task":x?"Add New Subtask":"Add New Task"}),e.jsx("button",{className:"task-modal-close-btn",type:"button",onClick:D,"aria-label":"Close modal",children:"×"})]}),e.jsx("div",{className:"task-modal-body",children:e.jsxs("form",{id:"taskForm",onSubmit:de,children:[e.jsxs("div",{className:"task-form-group",children:[e.jsxs("label",{className:"task-form-label",children:[x?"Subtask Name":"Task Name",e.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),e.jsx("input",{type:"text",className:"task-input-field",name:"task_name",id:"taskName",placeholder:x?"Enter subtask name":"Enter task name",value:u.task_name,onChange:w,required:!0}),e.jsx("div",{className:"task-error-message",id:"taskNameError",style:{display:Fe&&!u.task_name?"block":"none"},children:x?"Subtask name is required":"Task name is required"})]}),e.jsxs("div",{className:"task-form-group",children:[e.jsx("label",{className:"task-form-label",children:"Description"}),e.jsx("textarea",{className:"task-input-field",id:"taskDescription",name:"description",placeholder:"Add a description (optional)",value:u.description,onChange:w})]}),e.jsxs("div",{className:"task-form-row",children:[e.jsxs("div",{className:"task-form-group",children:[e.jsx("label",{className:"task-form-label",children:"Status"}),e.jsxs("select",{className:"task-input-field",id:"taskStatus",name:"status",value:u.status,onChange:w,children:[e.jsx("option",{value:"todo",children:"Todo"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"done",children:"Done"})]})]}),e.jsxs("div",{className:"task-form-group",children:[e.jsxs("label",{className:"task-form-label task-priority-label-header",children:["Priority",e.jsx("span",{className:"task-info-icon",children:"i"})]}),e.jsxs("select",{className:"task-input-field",id:"taskPriority",name:"priority",value:u.priority,onChange:w,children:[e.jsx("option",{value:1,children:"Low"}),e.jsx("option",{value:2,children:"Medium"}),e.jsx("option",{value:3,children:"High"}),e.jsx("option",{value:4,children:"Urgent"})]})]})]}),e.jsxs("div",{className:"task-form-group",children:[e.jsx("label",{className:"task-form-label",children:"Due Date"}),e.jsx("input",{type:"date",className:"task-input-field",id:"taskDueDate",name:"due_date",value:u.due_date,onChange:w})]}),e.jsxs("div",{className:"task-form-group",children:[e.jsx("label",{className:"task-form-label",children:"Attachments"}),e.jsxs("div",{style:{border:"2px dashed #cbd5e1",borderRadius:"8px",padding:"16px",textAlign:"center",cursor:"pointer",transition:"all 0.3s ease",backgroundColor:"#f8fafc"},children:[e.jsx("input",{type:"file",multiple:!0,onChange:Ce,style:{display:"none"},id:"fileInput",accept:"image/*,.pdf,.doc,.docx,.txt",disabled:g}),e.jsxs("label",{htmlFor:"fileInput",style:{cursor:g?"not-allowed":"pointer",display:"block",opacity:g?.6:1},children:[e.jsx($e,{size:24,style:{margin:"0 auto 8px",color:"#7c3aed"}}),e.jsx("p",{style:{margin:"8px 0 4px",color:"#334155",fontWeight:"500"},children:"Click to upload or drag files"}),e.jsx("p",{style:{margin:"0",color:"#94a3b8",fontSize:"0.875rem"},children:"Images, PDF, DOC, TXT (Max 10MB each)"})]})]}),f.length>0&&e.jsxs("div",{style:{marginTop:"16px"},children:[e.jsxs("p",{style:{fontSize:"0.875rem",color:"#475569",marginBottom:"8px",fontWeight:"500"},children:["Current Attachments: ",f.length]}),f.some(s=>R(s))&&e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("p",{style:{fontSize:"0.75rem",color:"#64748b",marginBottom:"8px"},children:"Images:"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(80px, 1fr))",gap:"8px"},children:f.filter(s=>R(s)).map(s=>e.jsxs("div",{style:{position:"relative",borderRadius:"6px",overflow:"hidden",border:"1px solid #e2e8f0",backgroundColor:"#f1f5f9"},children:[e.jsx("img",{src:s.fileUrl,alt:s.fileName,style:{width:"100%",height:"80px",objectFit:"cover"}}),e.jsx("button",{type:"button",onClick:()=>ae(s.id),style:{position:"absolute",top:"2px",right:"2px",background:"rgba(239, 68, 68, 0.9)",border:"none",color:"white",borderRadius:"50%",width:"20px",height:"20px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:"0",fontSize:"12px"},title:`Remove ${s.fileName}`,children:"×"})]},s.id))})]}),f.some(s=>!R(s))&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"0.75rem",color:"#64748b",marginBottom:"8px"},children:"Files:"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:f.filter(s=>!R(s)).map(s=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",backgroundColor:"#f1f5f9",borderRadius:"6px",border:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",minWidth:"0"},children:[e.jsx(ke,{size:18,style:{color:"#7c3aed",flexShrink:0}}),e.jsx("span",{style:{fontSize:"0.875rem",color:"#334155",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:s.fileName})]}),e.jsxs("div",{style:{display:"flex",gap:"4px",flexShrink:0},children:[e.jsx("a",{href:s.fileUrl,target:"_blank",rel:"noopener noreferrer",style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#3b82f6",display:"flex",alignItems:"center",flexShrink:0},title:"Download file",children:e.jsx(Me,{size:16})}),e.jsx("button",{type:"button",onClick:()=>ae(s.id),style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#ef4444",display:"flex",alignItems:"center",flexShrink:0},title:"Remove file",children:e.jsx(je,{size:16})})]})]},s.id))})]})]}),h.length>0&&e.jsxs("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e2e8f0"},children:[e.jsxs("p",{style:{fontSize:"0.875rem",color:"#475569",marginBottom:"8px",fontWeight:"500"},children:["New Files to Upload: ",h.length]}),h.some(s=>F.isImageFile(s))&&e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("p",{style:{fontSize:"0.75rem",color:"#64748b",marginBottom:"8px"},children:"Images:"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(80px, 1fr))",gap:"8px"},children:h.filter(s=>F.isImageFile(s)).map((s,n)=>e.jsxs("div",{style:{position:"relative",borderRadius:"6px",overflow:"hidden",border:"1px solid #d1fae5",backgroundColor:"#f0fdf4"},children:[e.jsx("img",{src:URL.createObjectURL(s),alt:s.name,style:{width:"100%",height:"80px",objectFit:"cover"},title:s.name}),e.jsx("button",{type:"button",onClick:()=>te(h.indexOf(s)),style:{position:"absolute",top:"2px",right:"2px",background:"rgba(239, 68, 68, 0.9)",border:"none",color:"white",borderRadius:"50%",width:"20px",height:"20px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:"0",fontSize:"12px"},title:`Remove ${s.name}`,children:"×"})]},n))})]}),h.some(s=>!F.isImageFile(s))&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"0.75rem",color:"#64748b",marginBottom:"8px"},children:"Files:"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:h.filter(s=>!F.isImageFile(s)).map((s,n)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",backgroundColor:"#ecfdf5",borderRadius:"6px",border:"1px solid #d1fae5"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",minWidth:"0"},children:[e.jsx(ke,{size:18,style:{color:"#10b981",flexShrink:0}}),e.jsx("span",{style:{fontSize:"0.875rem",color:"#334155",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:s.name}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"#6b7280"},children:["(",(s.size/1024/1024).toFixed(2)," MB)"]})]}),e.jsx("button",{type:"button",onClick:()=>te(h.indexOf(s)),style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#ef4444",display:"flex",alignItems:"center",flexShrink:0},title:"Remove file",children:e.jsx(je,{size:16})})]},n))})]})]})]})]})}),e.jsxs("div",{className:"task-modal-footer",children:[e.jsx("button",{type:"button",className:"task-btn task-btn-cancel",onClick:D,disabled:g,children:"Cancel"}),e.jsx("button",{type:"button",className:"task-btn task-btn-primary",onClick:de,disabled:g,style:{opacity:g?.6:1,cursor:g?"not-allowed":"pointer"},children:g?"Uploading...":k?x?"Save Subtask":"Save Task":x?"Add Subtask":"Add Task"})]})]})}),M&&e.jsx("div",{className:"task-modal-overlay",onClick:W,children:e.jsxs("div",{className:"task-modal",onClick:s=>s.stopPropagation(),style:{maxWidth:"400px",textAlign:"center"},children:[e.jsx("div",{className:"task-modal-header",style:{borderBottom:"none",justifyContent:"flex-end",padding:"12px 16px"},children:e.jsx("button",{className:"task-modal-close-btn",type:"button",onClick:W,"aria-label":"Close modal",children:"×"})}),e.jsxs("div",{className:"task-modal-body",style:{padding:"20px 32px 32px"},children:[e.jsx("div",{style:{width:"80px",height:"80px",margin:"0 auto 24px",borderRadius:"50%",background:"linear-gradient(135deg, rgba(124,58,237,0.1), rgba(124,58,237,0.05))",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid #7c3aed"},children:e.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"#7c3aed",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})})}),e.jsx("h2",{style:{fontSize:"1.5rem",color:"#0f172a",marginBottom:"12px",fontWeight:"600"},children:"Awesome!"}),e.jsxs("p",{style:{color:"#64748b",fontSize:"0.95rem",marginBottom:"28px"},children:[x?"Subtask":"Task"," successfully added to your list"]}),e.jsx("button",{type:"button",className:"task-btn task-btn-primary",onClick:W,style:{width:"100%",padding:"12px",fontSize:"1rem"},children:"Continue"})]})]})})]})}export{ns as default};
