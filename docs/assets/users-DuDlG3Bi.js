import{r as l,j as e}from"./vendor_react-ByBjJ8Oe.js";import{U as z}from"./UsersRepository-DpSQoiGu.js";import{a as k}from"./index-BZi0Xtwm.js";import{o as I,p as V}from"./vendor_firebase-i8bcTDRB.js";import"./vendor-DuPUYBON.js";function G(){const[o,d]=l.useState([]),[f,N]=l.useState([]),[b,y]=l.useState(!0),[p,S]=l.useState(null),[h,A]=l.useState(""),[u,U]=l.useState("all"),[m,w]=l.useState("all"),[L,c]=l.useState(!1),[a,r]=l.useState(null),[g,C]=l.useState(null);l.useEffect(()=>{let s=!0;const t=()=>{console.log("Fetching users..."),y(!0),z.getAll().then(i=>{console.log("Users fetched",i);const v=i.map(j=>({...j,department:j.department??"Engineering",status:j.status??"active",lastActive:j.lastActive??new Date().toLocaleDateString()}));s&&(d(v),N(v))}).catch(i=>{console.error("Users fetch error",i),s&&S(i?.message??"Failed to load users")}).finally(()=>{s&&y(!1)})},n=I(k,i=>{console.log("onAuthStateChanged",i),i?t():V(k).then(()=>console.log("Anonymous sign-in successful")).catch(v=>console.error("Anonymous sign-in failed",v))});return()=>{s=!1,n()}},[]),l.useEffect(()=>{let s=[...o];if(h){const t=h.toLowerCase();s=s.filter(n=>n.displayName?.toLowerCase().includes(t)||n.email?.toLowerCase().includes(t))}u!=="all"&&(s=s.filter(t=>t.role===u)),m!=="all"&&(s=s.filter(t=>t.status===m)),N(s)},[h,u,m,o]);const x=(s,t)=>{C({message:s,type:t}),setTimeout(()=>C(null),3e3)},E=()=>{x("Add user functionality coming soon","success")},M=s=>{r({...s}),c(!0)},R=()=>{a&&(d(o.map(s=>s.id===a.id?a:s)),x("User updated successfully","success"),c(!1),r(null))},D=s=>{d(o.map(t=>{if(t.id===s){const n=t.status==="active"?"inactive":"active";return x(`User ${n==="active"?"activated":"deactivated"} successfully`,"success"),{...t,status:n}}return t}))},F=(s,t)=>{window.confirm(`Are you sure you want to delete ${t}? This action cannot be undone.`)&&(d(o.filter(n=>n.id!==s)),x("User deleted successfully","success"))},B=s=>{if(!s)return"?";const t=s.split(" ");return t.length>1?`${t[0][0]}${t[1][0]}`.toUpperCase():s.substring(0,2).toUpperCase()},$=s=>{switch(s){case"admin":return"badge-admin";case"manager":return"badge-manager";default:return"badge-user"}},W=s=>{switch(s){case"active":return"badge-active";case"inactive":return"badge-inactive";case"pending":return"badge-pending";default:return"badge-active"}};return e.jsxs("div",{className:"user-management",children:[g&&e.jsx("div",{className:`notification notification-${g.type}`,children:g.message}),e.jsxs("div",{className:"um-header",children:[e.jsx("h1",{className:"um-title",children:"User Management"}),e.jsxs("button",{className:"btn-primary",onClick:E,children:[e.jsx("span",{className:"btn-icon",children:"+"}),"Add User"]})]}),e.jsxs("div",{className:"um-controls",children:[e.jsxs("div",{className:"search-box",children:[e.jsx("svg",{className:"search-icon",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:e.jsx("path",{d:"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16zM19 19l-4.35-4.35",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsx("input",{type:"text",className:"search-input",placeholder:"Search users...",value:h,onChange:s=>A(s.target.value)})]}),e.jsxs("div",{className:"filters",children:[e.jsxs("select",{className:"filter-select",value:u,onChange:s=>U(s.target.value),children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"user",children:"User"})]}),e.jsxs("select",{className:"filter-select",value:m,onChange:s=>w(s.target.value),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"pending",children:"Pending"})]})]})]}),b&&e.jsx("div",{className:"loading-state",children:"Loading users..."}),p&&e.jsxs("div",{className:"error-state",children:["Error: ",p]}),!b&&!p&&e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"users-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Department"}),e.jsx("th",{children:"Last Active"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:f.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"empty-state",children:"No users found matching your criteria"})}):f.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"user-cell",children:[s.photoURL?e.jsx("img",{src:s.photoURL,alt:s.displayName,className:"user-avatar"}):e.jsx("div",{className:"user-avatar user-avatar-placeholder",children:B(s.displayName||s.email)}),e.jsxs("div",{className:"user-info",children:[e.jsx("div",{className:"user-name",children:s.displayName||"No name"}),e.jsx("div",{className:"user-email",children:s.email||"No email"})]})]})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${$(s.role)}`,children:s.role||"user"})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${W(s.status)}`,children:s.status||"active"})}),e.jsx("td",{className:"cell-department",children:s.department||"N/A"}),e.jsx("td",{className:"cell-date",children:s.lastActive||"Never"}),e.jsx("td",{children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"action-btn action-btn-edit",onClick:()=>M(s),title:"Edit user",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:e.jsx("path",{d:"M11.333 2A1.886 1.886 0 0 1 14 4.667l-9 9-3.667 1 1-3.667 9-9z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("button",{className:"action-btn action-btn-toggle",onClick:()=>D(s.id),title:s.status==="active"?"Deactivate":"Activate",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[e.jsx("path",{d:"M14 8A6 6 0 1 1 2 8a6 6 0 0 1 12 0z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M8 8V4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}),e.jsx("button",{className:"action-btn action-btn-delete",onClick:()=>F(s.id,s.displayName||s.email||"this user"),title:"Delete user",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:e.jsx("path",{d:"M2 4h12M5.333 4V2.667a1.333 1.333 0 0 1 1.334-1.334h2.666a1.333 1.333 0 0 1 1.334 1.334V4m2 0v9.333a1.333 1.333 0 0 1-1.334 1.334H4.667a1.333 1.333 0 0 1-1.334-1.334V4h9.334z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]})})]},s.id))})]})}),L&&a&&e.jsx("div",{className:"modal-overlay",onClick:()=>c(!1),children:e.jsxs("div",{className:"modal-content",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{className:"modal-title",children:"Edit User"}),e.jsx("button",{className:"modal-close",onClick:()=>c(!1),children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-input",value:a.displayName||"",onChange:s=>r({...a,displayName:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-input",value:a.email||"",onChange:s=>r({...a,email:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Role"}),e.jsxs("select",{className:"form-select",value:a.role||"user",onChange:s=>r({...a,role:s.target.value}),children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Department"}),e.jsxs("select",{className:"form-select",value:a.department||"Engineering",onChange:s=>r({...a,department:s.target.value}),children:[e.jsx("option",{value:"Engineering",children:"Engineering"}),e.jsx("option",{value:"Design",children:"Design"}),e.jsx("option",{value:"Marketing",children:"Marketing"}),e.jsx("option",{value:"Sales",children:"Sales"}),e.jsx("option",{value:"Support",children:"Support"}),e.jsx("option",{value:"HR",children:"HR"}),e.jsx("option",{value:"Finance",children:"Finance"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:a.status||"active",onChange:s=>r({...a,status:s.target.value}),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"pending",children:"Pending"})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn-secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx("button",{className:"btn-primary",onClick:R,children:"Save Changes"})]})]})})]})}export{G as default};
