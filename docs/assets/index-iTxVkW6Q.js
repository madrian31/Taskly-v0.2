const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/login-CQDPEsEY.js","assets/vendor_react-ByBjJ8Oe.js","assets/vendor-DuPUYBON.js","assets/vendor_firebase-CZSQ0ZSP.js","assets/home-CdjIZOmV.js","assets/App-DEF85R_q.css","assets/task-CGzbebyn.js","assets/task-Bwuw-X_A.css","assets/users-CRk21FBV.js","assets/users-yjea5Z32.css","assets/dashboard-Boxj-FBi.js","assets/layout-BMUXP_KP.js","assets/layout-724H31W2.css","assets/main-layout-DlE6UP2U.js","assets/main-layout-BPKYgo-Z.css"])))=>i.map(i=>d[i]);
import{j as t,L as P,r as o,N as x,c as D,H as I,R as U,a as p}from"./vendor_react-ByBjJ8Oe.js";import{i as O,g as T,a as k,o as N,G as C,s as z,b as q,c as _,d as V,e as v,f as F,h as G,j as B,u as M,k as $,l as A}from"./vendor_firebase-CZSQ0ZSP.js";import"./vendor-DuPUYBON.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();const H="modulepreload",J=function(i){return"/Taskly-v0.2/"+i},E={},f=function(e,s,a){let r=Promise.resolve();if(s&&s.length>0){let y=function(l){return Promise.all(l.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=c?.nonce||c?.getAttribute("nonce");r=y(s.map(l=>{if(l=J(l),l in E)return;E[l]=!0;const m=l.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${g}`))return;const d=document.createElement("link");if(d.rel=m?"stylesheet":H,m||(d.as="script"),d.crossOrigin="",d.href=l,u&&d.setAttribute("nonce",u),document.head.appendChild(d),m)return new Promise((S,w)=>{d.addEventListener("load",S),d.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${l}`)))})}))}function n(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return r.then(c=>{for(const u of c||[])u.status==="rejected"&&n(u.reason);return e().catch(n)})};function K({id:i,children:e}){return t.jsx("section",{id:i,className:"section center",children:e})}function W(){return t.jsxs(K,{children:[t.jsx("h1",{children:"Taskly"}),t.jsx(P,{to:"/login",children:"Get Started"})]})}const X={apiKey:"AIzaSyDbeHsZ1hrXAnCRePrfJFqkSDelKOGtqJU",authDomain:"taskly-2542f.firebaseapp.com",projectId:"taskly-2542f",storageBucket:"taskly-2542f.firebasestorage.app",messagingSenderId:"141937666380",appId:"1:141937666380:web:8a8aa08b12e2e4490887e9",measurementId:"G-MY6GLXVEPJ"},R=O(X),j=T(R),h=k(R);class Y{onAuthStateChanged(e){return N(j,e)}async signInWithGoogle(){const e=new C;return await z(j,e)}async signOutUser(){await q(j)}getCurrentUser(){return j.currentUser}}const b=new Y;function Z({children:i}){const[e,s]=o.useState(void 0);return o.useEffect(()=>{const a=b.onAuthStateChanged(r=>{s(r)});return()=>a()},[]),e===void 0?t.jsx("div",{children:"Loading..."}):e?t.jsx(t.Fragment,{children:i}):t.jsx(x,{to:"/login",replace:!0})}function L(i,e){return{id:i,uid:e.uid??e.authUid??void 0,displayName:e.displayName??e.name,email:e.email,photoURL:e.photoURL,role:e.role??"user",department:e.department,status:e.status,lastActive:e.lastActive,createdAt:e.createdAt?.seconds?e.createdAt.seconds*1e3:e.createdAt??Date.now()}}class Q{constructor(){this.col=_(h,"users")}async getAll(){return(await V(this.col)).docs.map(s=>L(s.id,s.data()))}async getById(e){const s=v(h,"users",e),a=await F(s);return a.exists()?L(a.id,a.data()):null}async create(e){return(await G(_(h,"users"),{...e,createdAt:e.createdAt??Date.now()})).id}async upsertByUid(e,s){const a=v(h,"users",e);await B(a,{...s,uid:e,updatedAt:A(),createdAt:A()},{merge:!0})}async update(e,s){await M(v(h,"users",e),s)}async delete(e){await $(v(h,"users",e))}}const ee=new Q;function te({children:i,allowedRoles:e}){const[s,a]=o.useState(void 0),[r,n]=o.useState(void 0);return o.useEffect(()=>{const c=b.onAuthStateChanged(async u=>{if(a(u??null),u)try{const y=await ee.getById(u.uid);n(y?.role??"user")}catch(y){console.error("RequireRole: failed to fetch user document",y),n("user")}else n(void 0)});return()=>c()},[]),s===void 0?t.jsx("div",{children:"Loading..."}):s?r===void 0?t.jsx("div",{children:"Loading..."}):e.includes("everyone")||e.includes(r)?t.jsx(t.Fragment,{children:i}):t.jsx(x,{to:"/dashboard",replace:!0}):t.jsx(x,{to:"/login",replace:!0})}const re=o.lazy(()=>f(()=>import("./login-CQDPEsEY.js"),__vite__mapDeps([0,1,2,3])));o.lazy(()=>f(()=>import("./home-CdjIZOmV.js"),__vite__mapDeps([4,1,2,3,5])));const se=o.lazy(()=>f(()=>import("./task-CGzbebyn.js"),__vite__mapDeps([6,1,2,3,7,5]))),ne=o.lazy(()=>f(()=>import("./users-CRk21FBV.js"),__vite__mapDeps([8,1,2,3,9]))),oe=o.lazy(()=>f(()=>import("./dashboard-Boxj-FBi.js"),__vite__mapDeps([10,1,2,3,5]))),ie=o.lazy(()=>f(()=>import("./layout-BMUXP_KP.js"),__vite__mapDeps([11,1,2,12]))),ae=o.lazy(()=>f(()=>import("./main-layout-DlE6UP2U.js"),__vite__mapDeps([13,1,2,3,14])));D.createRoot(document.getElementById("root")).render(t.jsx(o.StrictMode,{children:t.jsx(I,{children:t.jsx(o.Suspense,{fallback:t.jsx("div",{children:"Loading..."}),children:t.jsxs(U,{children:[t.jsx(p,{path:"/",element:t.jsx(W,{})}),t.jsx(p,{element:t.jsx(ie,{}),children:t.jsx(p,{path:"/login",element:t.jsx(re,{})})}),t.jsxs(p,{element:t.jsx(Z,{children:t.jsx(ae,{})}),children:[t.jsx(p,{path:"/dashboard",element:t.jsx(oe,{})}),t.jsx(p,{path:"/task",element:t.jsx(se,{})}),t.jsx(p,{path:"/users",element:t.jsx(te,{allowedRoles:["admin"],children:t.jsx(ne,{})})})]})]})})})}));export{b as A,K as S,ee as U,j as a,h as d};
